(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[127],{8155:function(e,t,s){Promise.resolve().then(s.bind(s,8063))},7648:function(e,t,s){"use strict";s.d(t,{default:function(){return r.a}});var a=s(2972),r=s.n(a)},8063:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return c}});var a=s(7437),r=s(2265),n=s(7648),i=s(1837);function c(){let[e,t]=(0,r.useState)([]),[s,c]=(0,r.useState)(null),[o,l]=(0,r.useState)([]),[d,g]=(0,r.useState)(!0),[h,u]=(0,r.useState)(null),[x,m]=(0,r.useState)(""),[y,p]=(0,r.useState)(!1),[b,v]=(0,r.useState)(null),[f,N]=(0,r.useState)({name:"",description:""}),[j,C]=(0,r.useState)(!1),[w,S]=(0,r.useState)(!1);(0,r.useEffect)(()=>{let e=localStorage.getItem("dashboardAuth");e?(m(e),k(e)):k("")},[]);let k=async e=>{try{g(!0);let s=await i.h.getCategories(e);t(s),p(!0),g(!1)}catch(e){e.message.includes("401")?p(!1):u(e.message),g(!1)}},D=async()=>{try{await i.h.getCategories(x),localStorage.setItem("dashboardAuth",x),p(!0),k(x)}catch(e){u("Invalid password")}},O=async e=>{try{let t=await i.h.getCategoryCriteria(e,x);l(t.criteria),c(e)}catch(e){u(e.message)}},T=async()=>{if(s)try{S(!0),await i.h.updateCategoryCriteria(s,o,x),await k(x),S(!1)}catch(e){u(e.message),S(!1)}},A=(e,t,s)=>{let a=[...o];a[e]={...a[e],[t]:s},l(a)},E=e=>{l(o.filter((t,s)=>s!==e))},_=async a=>{if(confirm('Delete category "'.concat(a,'" and all its criteria?')))try{await i.h.deleteCategory(a,x),t(e.filter(e=>e.category!==a)),s===a&&(c(null),l([]))}catch(e){u(e.message)}};return y||d?d?(0,a.jsx)("div",{className:"min-h-screen bg-gray-900 text-white p-8",children:(0,a.jsx)("div",{className:"max-w-6xl mx-auto",children:(0,a.jsx)("div",{className:"animate-pulse",children:"Loading criteria..."})})}):(0,a.jsx)("div",{className:"min-h-screen bg-gray-900 text-white p-8",children:(0,a.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold",children:"Criteria Management"}),(0,a.jsxs)("p",{className:"text-gray-400 text-sm mt-1",children:[e.length," product categories with domain criteria"]})]}),(0,a.jsx)(n.default,{href:"/dashboard",className:"px-4 py-2 bg-indigo-600 hover:bg-indigo-700 rounded-lg text-sm transition-colors",children:"Back to Dashboard"})]}),h&&(0,a.jsxs)("div",{className:"bg-red-900/30 border border-red-700 rounded-lg p-4 mb-6",children:[(0,a.jsx)("span",{className:"text-red-400",children:h}),(0,a.jsx)("button",{onClick:()=>u(null),className:"ml-4 text-red-300 hover:text-white",children:"Dismiss"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-6",children:[(0,a.jsxs)("div",{className:"col-span-1 bg-gray-800 rounded-lg p-4",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Categories"}),(0,a.jsx)("div",{className:"space-y-2",children:e.map(e=>(0,a.jsxs)("div",{className:"p-3 rounded-lg cursor-pointer transition-colors ".concat(s===e.category?"bg-indigo-600":"bg-gray-700 hover:bg-gray-600"),onClick:()=>O(e.category),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"font-medium",children:e.category}),(0,a.jsx)("span",{className:"text-sm text-gray-300",children:e.criteria_count})]}),(0,a.jsxs)("div",{className:"text-xs text-gray-400 mt-1",children:["Source: ",e.source]})]},e.category))})]}),(0,a.jsx)("div",{className:"col-span-2 bg-gray-800 rounded-lg p-4",children:s?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("h2",{className:"text-lg font-semibold",children:['Criteria for "',s,'"']}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{onClick:()=>C(!0),className:"px-3 py-1 bg-green-600 hover:bg-green-700 rounded text-sm transition-colors",children:"+ Add Criterion"}),(0,a.jsx)("button",{onClick:T,disabled:w,className:"px-3 py-1 bg-indigo-600 hover:bg-indigo-700 rounded text-sm transition-colors disabled:opacity-50",children:w?"Saving...":"Save Changes"}),(0,a.jsx)("button",{onClick:()=>_(s),className:"px-3 py-1 bg-red-600 hover:bg-red-700 rounded text-sm transition-colors",children:"Delete Category"})]})]}),j&&(0,a.jsxs)("div",{className:"bg-gray-700 rounded-lg p-4 mb-4",children:[(0,a.jsx)("h3",{className:"font-medium mb-3",children:"New Criterion"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsx)("input",{type:"text",placeholder:"Name (snake_case)",value:f.name,onChange:e=>N({...f,name:e.target.value}),className:"px-3 py-2 bg-gray-600 rounded border border-gray-500 focus:outline-none focus:border-indigo-500"}),(0,a.jsx)("input",{type:"text",placeholder:"Unit (optional)",value:f.unit||"",onChange:e=>N({...f,unit:e.target.value||void 0}),className:"px-3 py-2 bg-gray-600 rounded border border-gray-500 focus:outline-none focus:border-indigo-500"}),(0,a.jsx)("input",{type:"text",placeholder:"Description",value:f.description,onChange:e=>N({...f,description:e.target.value}),className:"col-span-2 px-3 py-2 bg-gray-600 rounded border border-gray-500 focus:outline-none focus:border-indigo-500"})]}),(0,a.jsxs)("div",{className:"flex gap-2 mt-3",children:[(0,a.jsx)("button",{onClick:()=>{f.name&&f.description&&(l([...o,{...f}]),N({name:"",description:""}),C(!1))},className:"px-3 py-1 bg-green-600 hover:bg-green-700 rounded text-sm",children:"Add"}),(0,a.jsx)("button",{onClick:()=>C(!1),className:"px-3 py-1 bg-gray-600 hover:bg-gray-500 rounded text-sm",children:"Cancel"})]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[o.map((e,t)=>{var s;return(0,a.jsx)("div",{className:"bg-gray-700 rounded-lg p-3",children:b===t?(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-2",children:[(0,a.jsx)("input",{type:"text",value:e.name,onChange:e=>A(t,"name",e.target.value),className:"px-2 py-1 bg-gray-600 rounded border border-gray-500 text-sm"}),(0,a.jsx)("input",{type:"text",value:e.unit||"",placeholder:"Unit",onChange:e=>A(t,"unit",e.target.value),className:"px-2 py-1 bg-gray-600 rounded border border-gray-500 text-sm"}),(0,a.jsx)("input",{type:"text",value:(null===(s=e.options)||void 0===s?void 0:s.join(", "))||"",placeholder:"Options (comma-separated)",onChange:e=>A(t,"options",e.target.value.split(",").map(e=>e.trim()).filter(Boolean)),className:"px-2 py-1 bg-gray-600 rounded border border-gray-500 text-sm"})]}),(0,a.jsx)("input",{type:"text",value:e.description,onChange:e=>A(t,"description",e.target.value),className:"w-full px-2 py-1 bg-gray-600 rounded border border-gray-500 text-sm"}),(0,a.jsx)("button",{onClick:()=>v(null),className:"px-2 py-1 bg-indigo-600 rounded text-xs",children:"Done"})]}):(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"font-medium text-indigo-400",children:e.name}),e.unit&&(0,a.jsx)("span",{className:"text-xs bg-gray-600 px-2 py-0.5 rounded",children:e.unit}),e.options&&(0,a.jsxs)("span",{className:"text-xs text-gray-400",children:["[",e.options.join(", "),"]"]})]}),(0,a.jsx)("p",{className:"text-sm text-gray-300 mt-1",children:e.description})]}),(0,a.jsxs)("div",{className:"flex gap-1",children:[(0,a.jsx)("button",{onClick:()=>v(t),className:"px-2 py-1 bg-gray-600 hover:bg-gray-500 rounded text-xs",children:"Edit"}),(0,a.jsx)("button",{onClick:()=>E(t),className:"px-2 py-1 bg-red-600 hover:bg-red-700 rounded text-xs",children:"Delete"})]})]})},t)}),0===o.length&&(0,a.jsx)("div",{className:"text-center text-gray-400 py-8",children:'No criteria defined. Click "Add Criterion" to add one.'})]})]}):(0,a.jsx)("div",{className:"text-center text-gray-400 py-16",children:"Select a category to view and edit its criteria"})})]}),(0,a.jsxs)("div",{className:"mt-6 grid grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"bg-gray-800 rounded-lg p-4",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-green-400",children:e.filter(e=>"seed"===e.source).length}),(0,a.jsx)("div",{className:"text-sm text-gray-400",children:"Seeded Categories"})]}),(0,a.jsxs)("div",{className:"bg-gray-800 rounded-lg p-4",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-cyan-400",children:e.filter(e=>"discovered"===e.source).length}),(0,a.jsx)("div",{className:"text-sm text-gray-400",children:"Discovered Categories"})]}),(0,a.jsxs)("div",{className:"bg-gray-800 rounded-lg p-4",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-indigo-400",children:e.filter(e=>"manual"===e.source).length}),(0,a.jsx)("div",{className:"text-sm text-gray-400",children:"Manual Categories"})]})]})]})}):(0,a.jsx)("div",{className:"min-h-screen bg-gray-900 text-white flex items-center justify-center",children:(0,a.jsxs)("div",{className:"bg-gray-800 p-8 rounded-lg max-w-md w-full",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Criteria Management"}),(0,a.jsx)("p",{className:"text-gray-400 mb-4",children:"Enter password to access"}),h&&(0,a.jsx)("div",{className:"text-red-400 mb-4",children:h}),(0,a.jsx)("input",{type:"password",value:x,onChange:e=>m(e.target.value),placeholder:"Password",className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-lg mb-4 focus:outline-none focus:border-indigo-500",onKeyDown:e=>"Enter"===e.key&&D()}),(0,a.jsx)("button",{onClick:D,className:"w-full px-4 py-2 bg-indigo-600 hover:bg-indigo-700 rounded-lg transition-colors",children:"Login"})]})})}},1837:function(e,t,s){"use strict";s.d(t,{h:function(){return r}});class a{getAuthToken(){return localStorage.getItem("dashboard_auth_token")}async fetch(e,t){let s={"Content-Type":"application/json",...null==t?void 0:t.headers},a=this.getAuthToken();a&&(s["X-Dashboard-Auth"]=a);let r=await fetch("".concat(this.baseUrl).concat(e),{...t,headers:s});if(!r.ok)throw Error("API error: ".concat(r.status," ").concat(r.statusText));return r.json()}async getTraces(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50;return(await this.fetch("/traces/?limit=".concat(e))).traces}async getTrace(e){return this.fetch("/traces/".concat(e))}async deleteTrace(e){await this.fetch("/traces/".concat(e),{method:"DELETE"})}async runQuery(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"research";return this.fetch("/agent/run",{method:"POST",body:JSON.stringify({query:e,agent:t})})}async generateDrafts(e){return this.fetch("/agent/generate-drafts",{method:"POST",body:JSON.stringify(e)})}async lookupContacts(e){return(await this.fetch("/api/sellers/contacts",{method:"POST",body:JSON.stringify({domains:e})})).contacts}async getSellers(){return(await this.fetch("/api/sellers/")).sellers}async runDiscovery(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"IL";return this.fetch("/agent/run",{method:"POST",body:JSON.stringify({query:e,agent:"discovery",country:t})})}async runDiscoveryRefinement(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"IL",s=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0;return this.fetch("/agent/run",{method:"POST",body:JSON.stringify({query:e,agent:"discovery",country:t,conversation_history:s,session_id:a,parent_trace_id:r})})}async getCountry(){return this.fetch("/api/geo/country")}async startPriceSearch(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"IL";return this.fetch("/api/shopping-list/search-prices",{method:"POST",body:JSON.stringify({items:e,country:t})})}async getSearchStatus(e){return this.fetch("/api/shopping-list/search-status/".concat(e))}async getCategories(e){let t={};return e&&(t["X-Dashboard-Auth"]=e),(await this.fetch("/api/criteria/",{headers:t})).categories}async getCategoryCriteria(e,t){let s={};return t&&(s["X-Dashboard-Auth"]=t),this.fetch("/api/criteria/".concat(e),{headers:s})}async updateCategoryCriteria(e,t,s){let a={};return s&&(a["X-Dashboard-Auth"]=s),this.fetch("/api/criteria/".concat(e),{method:"PUT",headers:a,body:JSON.stringify({criteria:t})})}async createCategory(e,t,s){let a={};return s&&(a["X-Dashboard-Auth"]=s),this.fetch("/api/criteria/".concat(e),{method:"POST",headers:a,body:JSON.stringify({criteria:t})})}async deleteCategory(e,t){let s={};return t&&(s["X-Dashboard-Auth"]=t),this.fetch("/api/criteria/".concat(e),{method:"DELETE",headers:s})}constructor(e=""){this.baseUrl=e}}let r=new a}},function(e){e.O(0,[972,971,117,744],function(){return e(e.s=8155)}),_N_E=e.O()}]);